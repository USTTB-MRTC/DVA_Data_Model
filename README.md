# DVA_Data_Model

README.txt ‚Äì NONMEM Model DVA/PRR
=================================

üîé Objective
-----------
This pharmacodynamic (PD) model was developed to simulate the dynamics of parasite viability (DVA) and parasite reduction ratio (PRR) 
in response to various antimalarials (DHA, CQ, ATO, PYRI), using data from in vitro experiments. 
It implements an ON/OFF effect based on a LAGTIME to simulate the delayed drug response.

üìÇ File Structure
-----------------
- DVA_vs_PRR.csv: input data file containing DVA and PRR observations.
- runXXX.mod: NONMEM model file.
- sdtab001: standard output table with individual observations and predictions.
- patab001: output table for individual parameter estimates.


The dataset (`.csv`) and the model file (`.mod`) must be placed in the same folder.
All output files generated by NONMEM (e.g., `sdtab001`, `patab001`) will also be saved in this same folder

üß∞ Required Tools
-----------------
To run this model, you will need:

- NONMEM 7.5 
- PsN (optional but recommended for managing runs)
- Pirana (recommended for managing and visualizing model runs)
- R or Python (recommended for post-processing, graphics, NPDE, etc.)
- A text/code editor: RStudio, VS Code, or even Notepad++

üßæ Data Column Description
--------------------------
The data file must contain the following columns:

| Column     | Description                                                  |
|------------|--------------------------------------------------------------|
| ID         | Unique experiment identifier                                 |
| TIME       | Time after the start of the experiment (h)                   |
| AMT        | Dose added to the well                                       |
| CMT        | PD compartment (1 = DVA, 2 = PRR)                            |
| EVID       | NONMEM event type (0 = observation, 1 = dose)                |
| DV         | Observation (DVA = viable parasites, PRR = log10(viable+1)) |
| FLAG       | 1 = DVA, 2 = PRR                                             |
| MDV        | 1 = ignored by NONMEM, 0 = used                              |
| REPLICATE  | Experimental replicate                                       |
| CA, CB, CC, CD | Concentrations of compounds (DHA, CQ, ATO, PYRI)        |

üìä Dataset Structure by ID
--------------------------
The identifiers (ID) in the dataset correspond to the following combinations:

;; 3D7:
      ; ID.EQ.1 -------> DVA for DHA 
      ; ID.EQ.2 -------> DVA for CQ
      ; ID.EQ.3 -------> DVA for ATO
      ; ID.EQ.4 -------> DVA for PYRI  

      ; ID.EQ.5 -------> PRR for DHA 
      ; ID.EQ.6 -------> PRR for CQ
      ; ID.EQ.7 -------> PRR for ATO
      ; ID.EQ.8 -------> PRR for PYRI 

;; Field Isolates:
      ; ID.EQ.9 ------->  DVA for DHA 
      ; ID.EQ.10 -------> DVA for CQ
      ; ID.EQ.11 -------> DVA for ATO
      ; ID.EQ.12 -------> DVA for PYRI  

‚ö†Ô∏è For each run, make sure to modify the ACCEPT=(ID.EQ.X) clause in the $DATA block to target the desired experiment.

üîÑ What to Update for Each Run
------------------------------
1. Select the appropriate `ID` depending on the experiment (`ACCEPT=(ID.EQ.X)`)
2. Update the model file name (e.g., `run001.mod`)
3. Update output filenames in `$TABLE`, if needed : sdtab00X and patab00X

üì¶ Output Files
---------------
- sdtab00X: Individual data + predictions (IPRED)
- patab00X: Estimated parameter values

‚úçÔ∏è Author
---------
NONMEM model written by Mohamed MAIGA  
Year: 2025

